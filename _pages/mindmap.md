---
title: "OSCP Mindmap"
permalink: /mindmap/
date: 2022-01-31
---

WIP

<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>

</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@6.7.0"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.2.7"></script><script>((c,d,p)=>{const{Markmap:g}=c();window.mm=g.create("svg#mindmap",d==null?void 0:d(),p)})(()=>window.markmap,c=>(c=c||window.d3,{color:(N=>E=>N(E.p.i))(c.scaleOrdinal(c.schemeCategory10))}),{"t":"root","d":0,"v":"","c":[{"t":"heading","d":1,"p":{"lines":[0,1]},"v":"Meta Ideas","c":[{"t":"list_item","d":3,"p":{"lines":[1,2]},"v":"Reset box"},{"t":"list_item","d":3,"p":{"lines":[2,3]},"v":"google","c":[{"t":"list_item","d":5,"p":{"lines":[3,4]},"v":"errors"},{"t":"list_item","d":5,"p":{"lines":[4,5]},"v":"any urls"},{"t":"list_item","d":5,"p":{"lines":[5,6]},"v":"every version"},{"t":"list_item","d":5,"p":{"lines":[6,7]},"v":"every parameter"}]},{"t":"list_item","d":3,"p":{"lines":[7,8]},"v":"take a break!"}]},{"t":"heading","d":1,"p":{"lines":[9,10]},"v":"Recon"},{"t":"heading","d":1,"p":{"lines":[11,12]},"v":"Services","c":[{"t":"heading","d":2,"p":{"lines":[12,13]},"v":"SMB","c":[{"t":"list_item","d":4,"p":{"lines":[13,14]},"v":"General enumeration","c":[{"t":"list_item","d":6,"p":{"lines":[14,15]},"v":"<code>enum4linux -a [-u &quot;&lt;username&gt;&quot; -p &quot;&lt;passwd&gt;&quot;] &lt;IP&gt;</code>"},{"t":"list_item","d":6,"p":{"lines":[15,16]},"v":"<code>rpcclient -U &quot;&quot; -N &lt;IP&gt; #No creds</code>"}]},{"t":"list_item","d":4,"p":{"lines":[16,17]},"v":"null/guest session?","c":[{"t":"list_item","d":6,"p":{"lines":[17,18]},"v":"<code>smbmap -H &lt;IP&gt; [-P &lt;PORT&gt;] #Null user</code>"},{"t":"list_item","d":6,"p":{"lines":[18,19]},"v":"<code>crackmapexec smb &lt;IP&gt; -u '' -p '' --shares #Null user</code>"},{"t":"list_item","d":6,"p":{"lines":[19,20]},"v":"<code>crackmapexec smb &lt;IP&gt; -u 'username' -p 'password' --shares #Guest user</code>"},{"t":"list_item","d":6,"p":{"lines":[20,21]},"v":"<code>crackmapexec smb &lt;IP&gt; -u 'username' -H '&lt;HASH&gt;' --shares #Guest user</code>"}]},{"t":"list_item","d":4,"p":{"lines":[21,22]},"v":"read any dirs?"},{"t":"list_item","d":4,"p":{"lines":[22,23]},"v":"write any dirs?"},{"t":"list_item","d":4,"p":{"lines":[23,24]},"v":"More commands","c":[{"t":"list_item","d":6,"p":{"lines":[24,25]},"v":"<code>smbclient</code>","c":[{"t":"list_item","d":8,"p":{"lines":[25,26]},"v":"<code>smbclient --no-pass -L //&lt;IP&gt; # Null user</code>"}]},{"t":"list_item","d":6,"p":{"lines":[26,27]},"v":"<code>smbmap</code>","c":[{"t":"list_item","d":8,"p":{"lines":[27,28]},"v":"<code>smbmap -u &quot;username&quot; -p &quot;password&quot; -H &lt;IP&gt; [-P &lt;PORT&gt;] #Creds</code>"},{"t":"list_item","d":8,"p":{"lines":[28,29]},"v":"<code>smbmap -u &quot;username&quot; -p &quot;&lt;NT&gt;:&lt;LM&gt;&quot; -H &lt;IP&gt; [-P &lt;PORT&gt;] #Pass-the-Hash</code>"},{"t":"list_item","d":8,"p":{"lines":[29,30]},"v":"<code>smbmap [-u &quot;username&quot; -p &quot;password&quot;] -R [Folder] -H &lt;IP&gt; [-P &lt;PORT&gt;] # Recursive list</code>"},{"t":"list_item","d":8,"p":{"lines":[30,31]},"v":"<code>smbmap [-u &quot;username&quot; -p &quot;password&quot;] -r [Folder] -H &lt;IP&gt; [-P &lt;PORT&gt;] # Non-Recursive list</code>"},{"t":"list_item","d":8,"p":{"lines":[31,32]},"v":"<code>smbmap -u &quot;username&quot; -p &quot;&lt;NT&gt;:&lt;LM&gt;&quot; [-r/-R] [Folder] -H &lt;IP&gt; [-P &lt;PORT&gt;] #Pass-the-Hash</code>"}]},{"t":"list_item","d":6,"p":{"lines":[32,33]},"v":"<code>crackmapexec</code>","c":[{"t":"list_item","d":8,"p":{"lines":[33,34]},"v":"<code>crackmapexec smb &lt;IP&gt; -u '' -p '' --shares #Null user</code>"},{"t":"list_item","d":8,"p":{"lines":[34,35]},"v":"<code>crackmapexec smb &lt;IP&gt; -u 'username' -p 'password' --shares #Guest user</code>"},{"t":"list_item","d":8,"p":{"lines":[35,36]},"v":"<code>crackmapexec smb &lt;IP&gt; -u 'username' -H '&lt;HASH&gt;' --shares #Guest user</code>"}]}]},{"t":"list_item","d":4,"p":{"lines":[36,37]},"v":"Search for a file and download","c":[{"t":"list_item","d":6,"p":{"lines":[37,38]},"v":"<code>sudo smbmap -R Folder -H &lt;IP&gt; -A &lt;FileName&gt; -q</code>"}]},{"t":"list_item","d":4,"p":{"lines":[38,48]},"v":""}]},{"t":"heading","d":2,"p":{"lines":[38,40]},"v":"Manual download all","c":[{"t":"fence","d":3,"v":"<pre><code>smbclient //&lt;IP&gt;/&lt;share&gt;\n&gt; mask &quot;&quot;\n&gt; recurse\n&gt; prompt\n&gt; mget *\n#Download everything to current directory\n</code></pre>\n"},{"t":"list_item","d":3,"p":{"lines":[48,49]},"v":"Local user discovery brute force","c":[{"t":"list_item","d":5,"p":{"lines":[49,50]},"v":"<code>lookupsid.py -no-pass hostname.local</code>"}]}]},{"t":"heading","d":2,"p":{"lines":[50,51]},"v":"IIS","c":[{"t":"list_item","d":4,"p":{"lines":[51,52]},"v":"feroxbuster extensions: asp aspx config php"},{"t":"list_item","d":4,"p":{"lines":[53,54]},"v":"important files:","c":[{"t":"list_item","d":6,"p":{"lines":[54,59]},"v":"<pre><code>global.asax - optional file which handles startup ops\nconnectionstrings.config - can contain passwords!\nwindows lfi list: https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/\n</code></pre>\n"}]},{"t":"list_item","d":4,"p":{"lines":[59,60]},"v":"<a href=\"https://github.com/irsdl/IIS-ShortName-Scanner\">shortname scanning</a>"},{"t":"list_item","d":4,"p":{"lines":[61,62]},"v":"auth bypass IIS 7.5","c":[{"t":"list_item","d":6,"p":{"lines":[62,63]},"v":"<code>/admin:$i30:$INDEX_ALLOCATION/admin.php</code> or <code>/admin::$INDEX_ALLOCATION/admin.php</code>"}]}]},{"t":"heading","d":2,"p":{"lines":[63,64]},"v":"Tomcat 8080","c":[{"t":"list_item","d":4,"p":{"lines":[64,65]},"v":"dirb extensions: php war xml js jsp (windows: bat)"},{"t":"list_item","d":4,"p":{"lines":[65,66]},"v":"commmon files","c":[{"t":"list_item","d":6,"p":{"lines":[66,67]},"v":"/usr/share/tomcat9/etc/tomcat-users.xml - lists users"}]},{"t":"list_item","d":4,"p":{"lines":[67,68]},"v":"default creds","c":[{"t":"list_item","d":6,"p":{"lines":[68,69]},"v":"admin:admin"},{"t":"list_item","d":6,"p":{"lines":[69,70]},"v":"tomcat:tomcat"},{"t":"list_item","d":6,"p":{"lines":[70,71]},"v":"admin:<NOTHING>"},{"t":"list_item","d":6,"p":{"lines":[71,72]},"v":"admin:s3cr3t"},{"t":"list_item","d":6,"p":{"lines":[72,73]},"v":"tomcat:s3cr3t"},{"t":"list_item","d":6,"p":{"lines":[73,74]},"v":"admin:tomcat"}]},{"t":"list_item","d":4,"p":{"lines":[74,75]},"v":"path traversal bugs"},{"t":"list_item","d":4,"p":{"lines":[75,76]},"v":"<code>www.vulnerable.com/lalala/..;/manager/html</code>"},{"t":"list_item","d":4,"p":{"lines":[76,77]},"v":"<code>http://www.vulnerable.com/;param=value/manager/html</code>"},{"t":"list_item","d":4,"p":{"lines":[77,78]},"v":"Try to access /auth.jsp and if you are very lucky it might disclose the password in a backtrace."},{"t":"list_item","d":4,"p":{"lines":[78,79]},"v":"CVE-2007-1860 double encoding -&gt;","c":[{"t":"list_item","d":6,"p":{"lines":[79,80]},"v":"In order to access to the management web of the Tomcat go to: pathTomcat/%252E%252E/manager/html"},{"t":"list_item","d":6,"p":{"lines":[80,81]},"v":"Take into account that to upload the webshell you might need to use the double urlencode trick and send also a cookie and/or a SSRF token."}]},{"t":"list_item","d":4,"p":{"lines":[81,82]},"v":"<a href=\"https://www.rapid7.com/db/vulnerabilities/apache-tomcat-example-leaks/\">Check for all example leaks</a>"},{"t":"list_item","d":4,"p":{"lines":[82,83]},"v":"msfvenom reverse shell / web shell options"}]}]},{"t":"heading","d":1,"p":{"lines":[84,85]},"v":"Password cracking","c":[{"t":"list_item","d":3,"p":{"lines":[85,86]},"v":"hashtype identification","c":[{"t":"list_item","d":5,"p":{"lines":[86,87]},"v":"links"}]},{"t":"list_item","d":3,"p":{"lines":[87,88]},"v":"john"},{"t":"list_item","d":3,"p":{"lines":[88,89]},"v":"hashcat"}]},{"t":"heading","d":1,"p":{"lines":[90,91]},"v":"Web","c":[{"t":"list_item","d":3,"p":{"lines":[91,92]},"v":"nikto","c":[{"t":"list_item","d":5,"p":{"lines":[92,93]},"v":"<code>nikto -h http://$target-hostname:80</code>"}]},{"t":"list_item","d":3,"p":{"lines":[93,94]},"v":"directory brute force","c":[{"t":"list_item","d":5,"p":{"lines":[94,95]},"v":"feroxbuster","c":[{"t":"list_item","d":7,"p":{"lines":[95,96]},"v":"<code>feroxbuster -u http://$target-hostname/ -x txt php js</code>"},{"t":"list_item","d":7,"p":{"lines":[96,97]},"v":"no hits?","c":[{"t":"list_item","d":9,"p":{"lines":[97,98]},"v":"try bigger wordlists"},{"t":"list_item","d":9,"p":{"lines":[98,99]},"v":"specific wordlists (i.e. iis servers)"},{"t":"list_item","d":9,"p":{"lines":[99,100]},"v":"do the directories have a pattern?"},{"t":"list_item","d":9,"p":{"lines":[100,101]},"v":"expand scope of <code>-x</code> file extension parameter"}]}]}]},{"t":"list_item","d":3,"p":{"lines":[101,102]},"v":"subdomain brute force","c":[{"t":"list_item","d":5,"p":{"lines":[102,103]},"v":"ffuf","c":[{"t":"list_item","d":7,"p":{"lines":[103,104]},"v":"<code>ffuf -w /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -u http://$target-ip-H &quot;Host: FUZZ.$target-hostname&quot;</code>"},{"t":"list_item","d":7,"p":{"lines":[104,105]},"v":"<code>-fc</code> to filter HTTP status codes from response. i.e. <code>-fc 200</code>"},{"t":"list_item","d":7,"p":{"lines":[105,106]},"v":"<code>-fs</code> to filter HTTP response sie. i.e. <code>-fc 4242</code>"}]}]},{"t":"list_item","d":3,"p":{"lines":[106,107]},"v":"login page","c":[{"t":"list_item","d":5,"p":{"lines":[107,108]},"v":"brute force","c":[{"t":"list_item","d":7,"p":{"lines":[108,109]},"v":"<a href=\"https://book.hacktricks.xyz/brute-force#http-basic-auth\">HTTP basic auth</a>"},{"t":"list_item","d":7,"p":{"lines":[109,110]},"v":"<a href=\"https://book.hacktricks.xyz/brute-force#http-post-form\">POST auth</a>"},{"t":"list_item","d":7,"p":{"lines":[110,111]},"v":"ffuf brute forcing","c":[{"t":"list_item","d":9,"p":{"lines":[111,112]},"v":"Burp suite intercept -&gt; save request -&gt; update pass to FUZZ"},{"t":"list_item","d":9,"p":{"lines":[112,113]},"v":"<code>ffuf -request saved-request.txt -w /opt/SecLists/Passwords/xato-net-10-million-passwords-1000000.txt</code>"}]}]},{"t":"list_item","d":5,"p":{"lines":[113,114]},"v":"<a href=\"https://pentestlab.blog/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/\">sql injection bypass</a>"}]},{"t":"list_item","d":3,"p":{"lines":[114,115]},"v":"php fields?","c":[{"t":"list_item","d":5,"p":{"lines":[115,116]},"v":"sql injection? try to crash with ' &quot; and other commons","c":[{"t":"list_item","d":7,"p":{"lines":[116,117]},"v":"union based"},{"t":"list_item","d":7,"p":{"lines":[117,118]},"v":"login bypass"}]}]},{"t":"list_item","d":3,"p":{"lines":[118,119]},"v":"burpsuite","c":[{"t":"list_item","d":5,"p":{"lines":[119,120]},"v":"request tampering?"},{"t":"list_item","d":5,"p":{"lines":[120,121]},"v":"intercept"},{"t":"list_item","d":5,"p":{"lines":[121,122]},"v":"30X redirect attacks"}]},{"t":"list_item","d":3,"p":{"lines":[122,123]},"v":"tech stack (list more info like login page, default creds, hacktricks)","c":[{"t":"list_item","d":5,"p":{"lines":[123,124]},"v":"servers","c":[{"t":"list_item","d":7,"p":{"lines":[124,125]},"v":"nginx"},{"t":"list_item","d":7,"p":{"lines":[125,126]},"v":"tomcat"},{"t":"list_item","d":7,"p":{"lines":[126,127]},"v":"apache"}]},{"t":"list_item","d":5,"p":{"lines":[127,128]},"v":"software","c":[{"t":"list_item","d":7,"p":{"lines":[128,129]},"v":"drupal","c":[{"t":"list_item","d":9,"p":{"lines":[129,130]},"v":"drupalgeddon"}]},{"t":"list_item","d":7,"p":{"lines":[130,131]},"v":"wordpress","c":[{"t":"list_item","d":9,"p":{"lines":[131,132]},"v":"wpscan"}]}]}]},{"t":"list_item","d":3,"p":{"lines":[133,134]},"v":"iis","c":[{"t":"list_item","d":5,"p":{"lines":[134,135]},"v":"<a href=\"https://book.hacktricks.xyz/pentesting/pentesting-web/iis-internet-information-services\">HackTricks Pentesting IIS</a>"},{"t":"list_item","d":5,"p":{"lines":[135,137]},"v":""}]}]},{"t":"heading","d":1,"p":{"lines":[137,138]},"v":"Windows Privesc"},{"t":"heading","d":1,"p":{"lines":[140,141]},"v":"Linux Privesc"}],"p":{}})</script>
</body>
